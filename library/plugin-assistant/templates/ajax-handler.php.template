<?php
/**
 * AJAX Handler: {{action}}
 *
 * @package Plugin_AJAX
 */

// Prevent direct access.
if ( ! defined( 'ABSPATH' ) ) {
	exit;
}

/**
 * Handle {{action}} AJAX request.
 */
function {{prefix}}_ajax_{{action}}(): void {
	// Verify nonce.
	if ( ! check_ajax_referer( '{{prefix}}_{{action}}_nonce', 'nonce', false ) ) {
		wp_send_json_error( array( 'message' => __( 'Security check failed.', '{{prefix}}' ) ) );
	}
{{capability_check}}

	// Get and validate parameters.
{{params_code}}

	// Process the request here.

	wp_send_json_success(
		array(
			'message' => __( 'Action completed successfully.', '{{prefix}}' ),
			'data'    => array(),
		)
	);
}
add_action( 'wp_ajax_{{action}}', '{{prefix}}_ajax_{{action}}' );{{public_hook}}

/**
 * Enqueue AJAX script.
 */
function {{prefix}}_enqueue_{{action}}_script(): void {
	wp_enqueue_script(
		'{{prefix}}-{{action}}',
		plugin_dir_url( __FILE__ ) . '../assets/js/{{action}}.js',
		array( 'jquery' ),
		'1.0.0',
		true
	);

	wp_localize_script(
		'{{prefix}}-{{action}}',
		'{{prefix}}Ajax',
		array(
			'ajaxurl' => admin_url( 'admin-ajax.php' ),
			'nonce'   => wp_create_nonce( '{{prefix}}_{{action}}_nonce' ),
		)
	);
}
add_action( 'wp_enqueue_scripts', '{{prefix}}_enqueue_{{action}}_script' );
